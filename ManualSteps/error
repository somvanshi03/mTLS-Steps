# Get the pod name
POD=$(kubectl get pods -n flows-pen-test -l app=haproxy-egress -o jsonpath='{.items[0].metadata.name}')

# Check if files exist and their size
kubectl exec -it $POD -n flows-pen-test -- ls -la /etc/mtls/

# Check the CA bundle content (first few lines)
kubectl exec -it $POD -n flows-pen-test -- cat /etc/mtls/visa-ca-bundle.crt | head -20

# Check the client certificate content
kubectl exec -it $POD -n flows-pen-test -- cat /etc/mtls/visa-client-combined.pem | head -20

# Decode and check CA bundle from secret
kubectl get secret -n flows-pen-test haproxy-mtls-secret -o jsonpath='{.data.visa-ca-bundle\.crt}' | base64 -d | head -20

# Decode and check client certificate
kubectl get secret -n flows-pen-test haproxy-mtls-secret -o jsonpath='{.data.visa-client-combined\.pem}' | base64 -d | head -20

